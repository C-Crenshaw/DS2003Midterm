---
title: "Mid Term Project"
author: "Lexi Van Metre, Andrew Holzwarth, Dylan Cole, & Carson Crenshaw"
date: "2023-03-17"
output: html_document
---

# Grabbing the Data Set 
```{r}
library(dplyr)
library(ggplot2)
library(plotly)
library(tidyverse)

nbadata <- read.csv("nbadata.csv")

# View first 5 rows of NBA data 
head(nbadata)
```

# Data Wrangling
```{r}
#Remove unnecessary variables
nbadata_wrangled <- nbadata[,c(1:12,62)]
# Isolate unique game values (each game_id has 2 values, 1 for each team)
nbaunique <- nbadata_wrangled[!duplicated(nbadata_wrangled[ , c(1, 5)]), ]
#Clean up data (make all lowercase), aesthetics
names(nbaunique) <- tolower(names(nbaunique))

# View first 5 rows of the NBA data subset
head(nbaunique)

# Make factor variables
nbaunique$h_a <- as.factor(nbaunique$h_a)
nbaunique$ot <- as.factor(nbaunique$ot)
nbaunique$team_abbrev <- as.factor(nbaunique$team_abbrev)
nbaunique$season <- as.factor(nbaunique$season)

```

# Grouping the Data to Narrow the Data Down by Team Average
```{r}

nba_average <- nbaunique %>%
  group_by(team_abbrev, season) %>%
  summarize(team_score = mean(team_score),
            team_pace = mean(team_pace),
            team_efg_pct = mean(team_efg_pct),
            team_tov_pct = mean(team_tov_pct),
            team_orb_pct = mean(team_orb_pct),
            team_ft_rate = mean(team_ft_rate),
            team_off_rtg = mean(team_off_rtg))
nba_average

head(nba_average)
```


# Question 1 
### Is there a trend between team efg percentage and offensive rating by team?
```{r}
question_1_plot <- ggplot(nba_average, aes(x = team_efg_pct, y = team_off_rtg))+
  geom_point(aes(color = team_abbrev, shape = season))+
  geom_smooth(color = "black", method = "lm", se = FALSE)+
  labs(title = "Connection between FG% and Offensive Rating", 
       subtitle = "Strong Positive Trend")+
  ylab("Team Offensive Rating")+
  xlab("Team Effective Field Goal Percentage")+
  theme_bw()

question_1_plot
```

### 1.1: Does the general positive trend vary across NBA seasons 2020-2022? 
```{r}
question_1.1_plot <- ggplot(nba_average, aes(x = team_efg_pct, y = team_off_rtg))+
  geom_point(aes(color = team_abbrev, shape = season))+
  geom_smooth(color = "black", method = "lm", se = FALSE)+
  labs(title = "Connection between FG% and Offensive Rating", 
       subtitle = "NBA 2020-2022 Season")+
  ylab("Team Offensive Rating")+
  xlab("Team Effective Field Goal Percentage")+
  theme_bw()+
  facet_wrap(vars(season))
  
question_1.1_plot
```

# Question 2:
### Is there a trend between team_ft_rate (which we are using to track fouls), and total score, sorted by team and season?
```{r}
question_2_plot <- ggplot(nba_average, aes(x = team_ft_rate, y = team_score))+
  geom_point(aes(color = team_abbrev, shape = season))+
  geom_smooth(color = "black", method = "lm", se = FALSE)+
  labs(title = "Can Fouling Lead to More Points?")+
  ylab("Team Score")+
  xlab("Team Free Throw Rate")+
  theme_bw()

question_2_plot
```

### 2.2 Are there any trends when looking across seasons for question 2? 
```{r}

question_2.1_plot <- ggplot(nba_average, aes(x = team_ft_rate, y = team_score,color = team_abbrev, shape = season))+
  geom_point()+
  geom_smooth(color = "black", method = "lm", se = FALSE)+
  labs(title = "Can Fouling Lead to More Points?",
       subtitle = "NBA 2020-2022 Season")+
  ylab("Team Score")+
  xlab("Team Free Throw Rate")+
  theme_bw()+
  facet_wrap(vars(season))
question_2.1_plot

```

